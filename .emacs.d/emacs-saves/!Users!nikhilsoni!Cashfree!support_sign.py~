import settings

initial = {
'secretKey': settings.CASH_FREE['secretKey'],
'appId': settings.CASH_FREE['appId'],
'orderId': txn,
'orderAmount': price,
'orderCurrency':"INR",
'orderNote':voucher,
'customerEmail': user.email,
'customerPhone':profile.mobile_number,
'customerName':user.first_name,
'returnUrl':settings.CASH_FREE['returnUrl']+'/'+str(user_id)+'/'+str(plan_id)+'/'+txn,
'notifyUrl':settings.CASH_FREE['notifyUrl'],
}

sortedKeys = sorted(initial)
print(sortedKeys)
signatureData = ""
for key in sortedKeys:
    print(initial[key])
    signatureData += str(key) + str(initial[key])

message = signatureData.encode('utf-8')
#get secret key from your config
secret = secretKey.encode('utf-8')
signature = base64.b64encode(hmac.new(secret, message,digestmod=hashlib.sha256).digest())

print(signature)
