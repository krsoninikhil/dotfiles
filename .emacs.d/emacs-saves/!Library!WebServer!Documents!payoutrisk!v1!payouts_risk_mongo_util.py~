import datetime


def update(mongo, account_id, result):
    collec = mongo.cfsellers.PayoutRiskData
    res = collec.update_one(
        {'accountId': account_id, 'date': datetime.datetime.today()},
        {'$set': result},
        upsert = True
    )

def get_data(mongo, account_id, cf_bene_id):
    collec = mongo.cfsellers.PayoutRiskData
    today = datetime.datetime.today()
    to_date = datetime.datetime(today.year, today.month, today.day)
    from_date = to_date - datetime.timedelta(7)
    res = collec.find_one(
        {'accountId': account_id, 'TRUSTED_BENE_AMOUNT': cf_bene_id, 'date': {
            '$gte': from_date,
            '$lt': to_date
        }},
        {'TRUSTED_BENE_AMOUNT.$': 1, 'NEW_BENE_AMOUNT': 1, '_id': 0}
    )
    print(res)
    return res
