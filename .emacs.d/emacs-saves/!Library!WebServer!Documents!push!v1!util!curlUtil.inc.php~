<?php

class CurlUtil {

	public static function post($curlData, $curlUrl, $custHeader=null, $contentTypeJson=true){
		$result = "";
		$timeout = 30;

		$ch = curl_init();
		$fields_string = "";

		if ($contentTypeJson) {
			$fields_string = json_encode($curlData);
		} else {
			$fields_string = http_build_query($curlData);
		}

		if ($custHeader) {
			curl_setopt($ch, CURLOPT_HTTPHEADER, $custHeader);
		}

		if (strpos($curlUrl, '?') !== false) {
			$curlUrl .= "&";
		} else {
			$curlUrl .= "?";
		}

		if ($custHeader) {
			// $custHeader should be an array of required custom headers
			curl_setopt($ch, CURLOPT_HTTPHEADER, $custHeader);
		}

		curl_setopt($ch, CURLOPT_URL, "$curlUrl");
		curl_setopt($ch, CURLOPT_POST, count($curlData));
		curl_setopt($ch, CURLOPT_POSTFIELDS, $fields_string);
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
		curl_setopt($ch, CURLOPT_TIMEOUT, $timeout);
		$curl_result = curl_exec($ch);
		curl_close($ch);
		// // log request
		// error_log("POST: $curlUrl HEADERS: ".json_encode($custHeader)." DATA: $fields_string RESPONSE: $curl_result");
		return $curl_result;
	}
}

?>
