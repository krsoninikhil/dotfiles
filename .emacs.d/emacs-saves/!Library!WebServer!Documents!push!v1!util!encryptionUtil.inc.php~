<?php


    public static function pgpDecryptVerify($data, $pvtKeyPath, $bankPubKeyPath) {
        $pvtKey = file_get_contents($pvtKeyPath);
        $pubKey = file_get_contents($bankPubKeyPath);
        putenv("GNUPGHOME=/pubkeys/.gnupg");

        $gpg = new gnupg();
        $pvtKeyInfo = $gpg->import($pvtKey);
        $pubKeyInfo = $gpg->import($pubKey);
        $gpg->addsignkey($pubKeyInfo["fingerprint"]);
        $gpg->adddecryptkey($pvtKeyInfo["fingerprint"]);
        $plainText = "";
        $res = $gpg->decrypt($data, $plainText);
        //$res = $gpg->decryptverify($data, $plainText);
        error_log("decrypt".json_encode($res));
        return $res;
    }

?>
